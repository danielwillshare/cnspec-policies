query title: Ensure Microsoft Word Remote Code Execution Vulnerability for Office is not on the system
query description: The critical vulnerability CVE-2023-21716 is a Microsoft Word RTF Font Table Heap Corruption and allows attackers to achieve remote code execution with the victim's privileges that opens a malicious RTF document. More information can be found at (https://qoop.org/publications/cve-2023-21716-rtf-fonttbl.md)[https://qoop.org/publications/cve-2023-21716-rtf-fonttbl.md]

query remediation: Please update your Office installation or use the workaround. More information can be found at (https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-21716)[https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-21716].

query title: Block opening RTF documents (workaround)
query description: The critical vulnerability CVE-2023-21716 is a Microsoft Word RTF Font Table Heap Corruption and allows attackers to achieve remote code execution with the victim's privileges that opens a malicious RTF document. More information can be found at (https://qoop.org/publications/cve-2023-21716-rtf-fonttbl.md)[https://qoop.org/publications/cve-2023-21716-rtf-fonttbl.md]

Use Microsoft Office File Block policy to prevent Office from opening RTF documents from unknown or untrusted sources.

Impact of workaround: Email messages viewed in plain text format will not contain pictures, specialized fonts, animations, or other rich content. In addition, the following behavior may be experienced:

  - The changes are applied to the preview pane and to open messages.
  - Pictures become attachments so that they are not lost.
  - Because the message is still in Rich Text or HTML format in the store, the object model (custom code solutions) may behave unexpectedly.

query remediation: **For Office 2013**

Run regedit.exe as Administrator and navigate to the following subkey:

  

  Set the RtfFiles DWORD value to 2.

  Set the OpenInProtectedView DWORD value to 0.

**For Office 2016/ 2019/ 2021**

Run regedit.exe as Administrator and navigate to the following subkey:

  
  
  Set the RtfFiles DWORD value to 2.

  Set the OpenInProtectedView DWORD value to 0.

query title: Ensure Microsoft Word Remote Code Execution Vulnerability for SharePoint is not on the system
query description: The critical vulnerability CVE-2023-21716 is a Microsoft Word RTF Font Table Heap Corruption and allows attackers to achieve remote code execution with the victim's privileges that opens a malicious RTF document. More information can be found at (https://qoop.org/publications/cve-2023-21716-rtf-fonttbl.md)[https://qoop.org/publications/cve-2023-21716-rtf-fonttbl.md]

query remediation: Please update your SharePoint installation. More information can be found at (https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-21716)[https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-21716]

policy description: ## Overview

Mondoo Microsoft Vulnerability Policy checks for Windows and Microsoft Application vulnerabilities. It should be used in combination with the Platform Vulnerability Policy to identify missing patches.

### Run policy

To run this policy against a Windows system:



## Join the community!

Our goal is to build policies that are simple to deploy, accurate, and actionable. 

If you have any suggestions on how to improve this policy, or if you need support, [join the community](https://github.com/orgs/mondoohq/discussions) in GitHub Discussions.

